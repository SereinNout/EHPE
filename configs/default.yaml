seed: 42
device: "cuda"

data:
  img_size: 256
  num_joints: 21
  tw_joints: 6     # 5 tips + 1 wrist
  depth_bins: 8    # d = 8
  heatmap_size: 64 # 2D heatmap resolution
  use_normalized_coords: true

model:
  backbone:
    name: "resnet50"
    pretrained: true
    out_channels: 2048
    feat_hw: 8
  hourglass:
    stacks: 2
    channels: 256
    depth: 4
  refinement:
    channels: 256
    num_residual: 8
    num_pools: 4
    use_bn: true
  tw_head:
    softargmax_beta: 1.0
  pg:
    node_dim: 512
    gat:
      layers: 2
      heads: 8
      dropout: 0.1
    fem:
      layers: 2
      heads: 8
      mlp_ratio: 4
      dropout: 0.1
    fusion:
      init_omega_g: "identity"
      init_omega_e: "ones"
      learnable: true

loss:
  tw:
    lambda_h: 3.0
    lambda_ed: 1.0e-2
    lambda_r: 1.0e-2
  pg:
    lambda_p: 2.0e-2
    lambda_e: 2.0e-1
  heatmap_sigma: 2.0

train:
  dataset: "interhand"
  batch_size: 32
  num_workers: 8
  amp: true

  tw:
    epochs: 20
    lr: 1.0e-3
    weight_decay: 0.0
  pg:
    epochs: 40
    lr: 1.0e-4
    weight_decay: 0.0
    lr_milestones: [15, 20]
    lr_gamma: 0.1

logging:
  log_interval: 50
  save_dir: "outputs/ehpe"

interhand:
  image_root: "/path/to/InterHand2.6M/images"
  ann_path: "/path/to/your/train_annotations.json"
  cam_path: ""
  rel_depth_range_mm: 200.0
